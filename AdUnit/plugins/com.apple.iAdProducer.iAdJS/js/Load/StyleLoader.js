
/**
*
* Copyright Â© 2009-2011 Apple Inc.  All rights reserved.
*
**/

iAd.Class({name:"iAd.StyleLoader",superclass:iAd.Loader});iAd.StyleLoader.DEFAULT_TIMEOUT=0;iAd.StyleLoader.prototype.startLoad=function(){var a=this._element=document.createElement("link");a.rel="stylesheet";a.href=this._url;if(iAd.CSS.isStyleSheetLoaded(this.resolvedURL)){this._element=iAd.CSS.elementForStyleSheet(this.resolvedURL);this.notifyLoaderDidComplete();return}document.head.appendChild(a);iAd.StyleLoader.enqueueStyleLoader(this)};iAd.StyleLoader.prototype.abortLoad=function(){if(this._element){document.head.removeChild(this._element);iAd.StyleLoader.dequeueStyleLoader(this)}};iAd.StyleLoader.prototype.getSupportingObject=function(){return this._element};iAd.StyleLoader.prototype.getResolvedURL=function(){return this._element?this._element.href:this.callSuper()};iAd.StyleLoader.stylesheetsLoadingQueue={};iAd.StyleLoader.stylesheetsLoadPoller=null;iAd.StyleLoader.enqueueStyleLoader=function(b){var c=b.resolvedURL;var a=iAd.StyleLoader.stylesheetsLoadingQueue;if(a.hasOwnProperty(c)){a[c].push(b)}else{a[c]=[b]}if(iAd.StyleLoader.stylesheetsLoadPoller==null){iAd.StyleLoader.stylesheetsLoadPoller=window.setInterval(iAd.StyleLoader.pollStylesheetLoad,50)}};iAd.StyleLoader.dequeueStyleLoader=function(b){var a=iAd.StyleLoader.stylesheetsLoadingQueue;var c=b.resolvedURL;if(a.hasOwnProperty(c)){iAd.Array.removeObjectFromArray(b,a[c])}if(a[c].length==0){delete a[c]}};iAd.StyleLoader.pollStylesheetLoad=function(){var a=iAd.StyleLoader.stylesheetsLoadingQueue;for(var b in a){if(iAd.CSS.isStyleSheetLoaded(b)){a[b].forEach(function(c){c.notifyLoaderDidComplete()});delete a[b]}}if(Object.keys(a).length==0){window.clearInterval(iAd.StyleLoader.stylesheetsLoadPoller);iAd.StyleLoader.stylesheetsLoadPoller=null}};