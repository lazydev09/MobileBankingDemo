
/**
*
* Copyright Â© 2009-2011 Apple Inc.  All rights reserved.
*
**/

iAd.Class({name:"iAP.EventDelegate",superclass:iAd.Object,synthesizedProperties:["eventHandlers","target","userScriptFunction","executionContext"]});iAP.EventDelegate.prototype.init=function(c,b,a){this.renamedEvents={};this.renamedEvents.flipViewDidFlip="containerDidFocusCellAtIndex";this.renamedEvents.audioButtonDidPlay="mediaDidPlay";this.renamedEvents.audioButtonDidPause="mediaDidPause";this.renamedEvents.audioButtonDidEnd="mediaDidEnd";this.renamedEvents.audioButtonDidTimeUpdate="mediaDidTimeUpdate";this.renamedEvents.didReceiveResponseData="mapViewDidReceiveResponseData";this.renamedEvents.didReceiveDataFailure="mapViewDidReceiveDataFailure";this.renamedEvents.annotationCalloutTapped="mapViewDidTapAnnotationCallout";if(iAd.VideoPlayer&&c instanceof iAd.VideoPlayer){this.renamedEvents.mediaDidPlay="mediaPlaybackDidStart";this.renamedEvents.mediaDidPause="mediaPlaybackDidPause";this.renamedEvents.mediaDidEnd="mediaPlaybackDidEnd";this.renamedEvents.mediaDidTimeUpdate="mediaPlaybackDidProgress";this.renamedEvents.mediaDidEnterWaitingState="mediaPlaybackDidBeginWaiting";this.renamedEvents.mediaDidExitWaitingState="mediaPlaybackDidEndWaiting"}if(iAP.AudioButton&&c instanceof iAP.AudioButton){this.renamedEvents.audioButtonDidPlay="mediaPlaybackDidStart";this.renamedEvents.audioButtonDidPause="mediaPlaybackDidPause";this.renamedEvents.audioButtonDidEnd="mediaPlaybackDidEnd";this.renamedEvents.audioButtonDidTimeUpdate="mediaDidUpdateTime";this.renamedEvents.mediaDidPlay="mediaPlaybackDidStart";this.renamedEvents.mediaDidPause="mediaPlaybackDidPause";this.renamedEvents.mediaDidEnd="mediaPlaybackDidEnd";this.renamedEvents.mediaDidTimeUpdate="mediaDidUpdateTime"}this.callSuper();this._target=c;this._executionContext=b;this._userScriptFunction=a;this._eventHandlers={};if(b==null){this._executionContext=this}};iAP.EventDelegate.prototype.processUserScript=function(){for(var a in this.eventHandlers){var b=this.eventHandlers[a];this.target.removeEventListener(a,this,false);this.executionContext["on"+a.substr(0,1).toUpperCase()+a.substr(1)]=null}this._eventHandlers={};this.userScriptFunction.call(this.executionContext);for(key in this.executionContext){if(key.substr(0,2)!="on"){continue}var c=this.executionContext[key];if(typeof c=="function"){a=key.substr(2,1).toLowerCase()+key.substr(3);if(this.renamedEvents[a]){a=this.renamedEvents[a]}this.target.addEventListener(a,this,false);this.eventHandlers[a]=c}}};iAP.EventDelegate.prototype.handleEvent=function(b){var a=this.eventHandlers[b.type];if(a!=null&&b.ad&&b.ad.sender===this.target){if(b["arguments"]){a.apply(this.executionContext,b["arguments"])}else{a.call(this.executionContext,b)}}};iAP.EventDelegate.viewScriptFunctions={};iAP.EventDelegate.viewControllerScriptFunctions={};iAP.EventDelegate.registerViewControllerEventDelegate=function(b,a){iAP.EventDelegate.viewControllerScriptFunctions[b]=a};iAP.EventDelegate.registerViewEventDelegate=function(b,c,a){if(iAP.EventDelegate.viewScriptFunctions[c]==null){iAP.EventDelegate.viewScriptFunctions[c]={}}iAP.EventDelegate.viewScriptFunctions[c][b]=a};